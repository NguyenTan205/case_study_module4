<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <title>ƒê·ªïi m·∫≠t kh·∫©u</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .card {
            max-width: 420px;
            margin: 60px auto;
            border-radius: 16px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }
        .form-control {
            border-radius: 10px;
            padding-right: 40px;
        }
        .input-group-text {
            background: transparent;
            border-left: none;
        }
        .btn-primary {
            width: 100%;
            border-radius: 10px;
            padding: 10px;
        }
        .input-group:focus-within .form-control {
            border-color: #0d6efd;
            box-shadow: 0 0 0 0.15rem rgba(13,110,253,.25);
        }
    </style>
</head>
<body>

<div class="card p-4">
    <h3 class="text-center mb-4">ƒê·ªïi m·∫≠t kh·∫©u</h3>

    <div th:if="${success}" class="alert alert-success text-center">
        <span th:text="${success}"></span>
    </div>

    <form th:action="@{/change-password}" th:object="${changePasswordForm}" method="post">

        <!-- M·∫≠t kh·∫©u c≈© -->
        <div class="mb-3">
            <label for="oldPassword" class="form-label">M·∫≠t kh·∫©u c≈©</label>
            <div class="input-group">
                <input type="password" th:field="*{oldPassword}" class="form-control" id="oldPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u c≈©">
                <span class="input-group-text" onclick="togglePassword('oldPassword', this)" style="cursor:pointer;">
          <i class="bi bi-eye" id="icon-oldPassword"></i>
        </span>
            </div>
            <div class="text-danger small" th:if="${#fields.hasErrors('oldPassword')}" th:errors="*{oldPassword}"></div>
        </div>

        <!-- M·∫≠t kh·∫©u m·ªõi -->
        <div class="mb-3">
            <label for="newPassword" class="form-label">M·∫≠t kh·∫©u m·ªõi</label>
            <div class="input-group">
                <input type="password" th:field="*{newPassword}" class="form-control" id="newPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi">
                <span class="input-group-text" onclick="togglePassword('newPassword', this)" style="cursor:pointer;">
          <i class="bi bi-eye" id="icon-newPassword"></i>
        </span>
            </div>
            <div class="text-danger small" th:if="${#fields.hasErrors('newPassword')}" th:errors="*{newPassword}"></div>
        </div>

        <!-- X√°c nh·∫≠n m·∫≠t kh·∫©u -->
        <div class="mb-4">
            <label for="confirmPassword" class="form-label">X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
            <div class="input-group">
                <input type="password" th:field="*{confirmPassword}" class="form-control" id="confirmPassword" placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi">
                <span class="input-group-text" onclick="togglePassword('confirmPassword', this)" style="cursor:pointer;">
          <i class="bi bi-eye" id="icon-confirmPassword"></i>
        </span>
            </div>
            <div class="text-danger small" th:if="${#fields.hasErrors('confirmPassword')}" th:errors="*{confirmPassword}"></div>
        </div>

        <button type="submit" class="btn btn-primary">ƒê·ªïi m·∫≠t kh·∫©u</button>
    </form>

    <!-- üîô N√∫t quay v·ªÅ -->
    <div class="text-center mt-4">
        <a th:if="${#authorization.expression('hasRole(''ADMIN'')')}" th:href="@{/admin/home}" class="btn btn-outline-primary btn-sm"><i class="bi bi-box-arrow-left">  Quay v·ªÅ trang ch·ªß</i></a>
        <a th:if="${#authorization.expression('hasRole(''TEACHER'')')}" th:href="@{/teacher/home}" class="btn btn-outline-primary btn-sm"><i class="bi bi-box-arrow-left">  Quay v·ªÅ trang ch·ªß</i></a>
        <a th:if="${#authorization.expression('hasRole(''STUDENT'')')}" th:href="@{/students/home}" class="btn btn-outline-primary btn-sm"><i class="bi bi-box-arrow-left">  Quay v·ªÅ trang ch·ªß</i></a>
    </div>
</div>

<script>
    function togglePassword(inputId, span) {
        const input = document.getElementById(inputId);
        const icon = span.querySelector('i');

        if (input.type === "password") {
            input.type = "text";
            icon.classList.replace("bi-eye", "bi-eye-slash");
        } else {
            input.type = "password";
            icon.classList.replace("bi-eye-slash", "bi-eye");
        }
    }
</script>

</body>
</html>
